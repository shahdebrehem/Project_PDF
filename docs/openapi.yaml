openapi: 3.0.3

info:
  title: SmartPDF API
  version: 0.1.0
  description: RESTful API for SmartPDF Graduation Project

servers:
  - url: /api

tags:
  - name: Auth
    description: Authentication
  - name: Password
    description: Password reset
  - name: User
    description: User profile
  - name: Settings
    description: Settings

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer

  schemas:
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: OK
        data:
          type: object
      required: [success, message, data]

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: Validation error
        errors:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
      required: [success, message]

    AuthUser:
      type: object
      properties:
        id:
          type: string
          example: "1"
        name:
          type: string
          example: "User Name"
        email:
          type: string
          example: "user@mail.com"
        language:
          type: string
          enum: [ar, en]
          example: en
        theme:
          type: string
          enum: [system, light, dark]
          example: system
      required: [id, name, email]

    AuthPayload:
      type: object
      properties:
        token:
          type: string
          example: "token_here"
        user:
          $ref: "#/components/schemas/AuthUser"
      required: [token, user]

    SignupRequest:
      type: object
      required: [name, email, password, password_confirmation]
      properties:
        name:
          type: string
          example: "Seham"
        email:
          type: string
          example: "seham@mail.com"
        password:
          type: string
          example: "12345678"
        password_confirmation:
          type: string
          example: "12345678"

    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          example: "seham@mail.com"
        password:
          type: string
          example: "12345678"

    ForgotPasswordRequest:
      type: object
      required: [email]
      properties:
        email:
          type: string
          example: "seham@mail.com"

    ResetPasswordRequest:
      type: object
      required: [email, token, password, password_confirmation]
      properties:
        email:
          type: string
          example: "seham@mail.com"
        token:
          type: string
          example: "483920"
          description: "6-digit OTP code sent to email (valid for 10 minutes)"

        password:
          type: string
          example: "newpassword123"
        password_confirmation:
          type: string
          example: "newpassword123"

    UpdateProfileRequest:
      type: object
      properties:
        name:
          type: string
          example: "New Name"

    ChangeLanguageRequest:
      type: object
      required: [language]
      properties:
        language:
          type: string
          enum: [ar, en]
          example: ar

    ChangeThemeRequest:
      type: object
      required: [theme]
      properties:
        theme:
          type: string
          enum: [system, light, dark]
          example: dark

    ChangePasswordRequest:
      type: object
      required: [current_password, new_password, new_password_confirmation]
      properties:
        current_password:
          type: string
          example: "12345678"
        new_password:
          type: string
          example: "newpassword123"
        new_password_confirmation:
          type: string
          example: "newpassword123"

paths:
  /auth/signup:
    post:
      tags: [Auth]
      summary: Sign up
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SignupRequest"
      responses:
        "200":
          description: Registered successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/AuthPayload"
        "422":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/login:
    post:
      tags: [Auth]
      summary: Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login success
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/AuthPayload"
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "422":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/logout:
    post:
      tags: [Auth]
      summary: Logout (revoke current token)
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Logged out
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/refresh:
    post:
      tags: [Auth]
      summary: Refresh token (issue new token & revoke current)
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Token refreshed
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/AuthPayload"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/forgot-password:
    post:
      tags: [Password]
      summary: Forgot password (send reset code (OTP) valid for 10 minutes)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequest"
      responses:
        "200":
          description: Reset code sent (if email exists)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "422":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/reset-password:
    post:
      tags: [Password]
      summary: Reset password with OTP code
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequest"
      responses:
        "200":
          description: Password updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "422":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /me:
    get:
      tags: [User]
      summary: Get current user profile
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Current user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/AuthUser"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    put:
      tags: [User]
      summary: Update current user profile (name only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateProfileRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/AuthUser"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "422":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /settings/language:
    put:
      tags: [Settings]
      summary:Change language (default: en)
      description: >
        Updates the user's language preference.
          Default language is "en".
           Allowed values are: ar, en
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChangeLanguageRequest"
      responses:
        "200":
          description: Language updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "422":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"


/settings/theme:
  put:
    tags: [Settings]
    summary: Change theme mode (default: system)
    description: >
      The default theme is "system", which follows the device appearance.
      Allowed values are: system, light, dark.
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ChangeThemeRequest"
    responses:
      "200":
        description: Theme updated successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      "401":
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ErrorResponse"
      "422":
        description: Validation error (invalid theme value)
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ErrorResponse"

    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ChangeThemeRequest"
    responses:
      "200":
        description: Theme updated successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      "401":
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ErrorResponse"
      "422":
        description: Validation error (invalid theme value)
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ErrorResponse"


  /settings/password:
    put:
      tags: [Settings]
      summary: Change password (revokes all tokens)
      description: >
        Changes the current user's password. For security, all existing access tokens
        are revoked, so the user must login again to get a new token.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChangePasswordRequest"
      responses:
        "200":
          description: Password changed. All tokens revoked; login required.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "422":
          description: Validation error (wrong current password or invalid new password)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  # -------------------------------------------------------------------
  # BACK TEAM SECTION (Files APIs) - Add your endpoints here

  # -------------------------------------------------------------------
  # AI TEAM SECTION (AI APIs) - Add your endpoints here
